<ion-view class="lockbox view-section min-size">

    <ion-header-bar align-title="center">
        <h1 class="title">Messages</h1>
    </ion-header-bar>

    <ion-pane class="content-pane">
        <ion-scroll>
            <ul class="list message-list">
                
                <li class="item" ng-repeat="chat in vm.chats" ng-click="vm.showChatDetailsModal(chat)">
                    <div class="ico ico-avatarsmall avatar-left"></div>
                    <div class="item-content">
                        <div class="top">
                            <p>{{chat.recipientName}}</p>
                            <span class="created"><i class="ico ico-timesmall"></i>{{chat.lastMessage.created | date:'mediumDate'}}</span>
                        </div>
                        <div class="message">
                            <span>{{chat.lastMessage.text}}</span>
                        </div>
                    </div>
                    <div class="new" ng-if="vm.updates.messages.byIds[chat.recipient]">
                        <div>
                            <span class="badge badge-assertive">{{vm.updates.messages.byIds[chat.recipient]}}</span>
                            <strong>NEW</strong>
                        </div>
                    </div>
                </li>
                
                <li class="item" ng-repeat="chat in vm.chats" ng-if="!vm.chats || !vm.chats.length">
                    <div class="item-content">
                        <div class="message">
                            <span>Get started by <a ui-sref="account.profile.friends">adding friends</a> or writing a new message below</span>
                        </div>
                    </div>
                </li>
                
            </ul>
        </ion-scroll>
        <button class="button content-button" ng-click="vm.createNewChat()">
            <i class="ico ico-shareiconorange"></i>
            New Message
        </button>
    </ion-pane>

</ion-view>
