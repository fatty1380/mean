<ion-view class="lockbox view-section min-size">

    <ion-header-bar>
        <button class="button button-icon icon ion-ios-arrow-back" ng-click="vm.goBack()"></button>
        <h1 class="title">Messages</h1>
    </ion-header-bar>

    <ion-pane class="content-pane">
        <ion-scroll>
            <ul class="list message-list">

                <li class="item" ng-repeat="chat in vm.chats" ng-click="vm.showChatDetailsModal(chat)">
                    <div class="ico ico-avatarsmall avatar-left"></div>
                    <div class="item-content">
                        <div class="top">
                            <p>{{chat.recipientName}}</p>
                            <span class="created"><i class="ico ico-timesmall"></i>{{chat.lastMessage.created | date:'mediumDate'}}</span>
                        </div>
                        <div class="message">
                            <span>{{chat.lastMessage.text}}</span>
                        </div>
                    </div>
                    <div class="new" ng-if="vm.updates.messages.byIds[chat.recipient]">
                        <div>
                            <span class="badge badge-assertive">{{vm.updates.messages.byIds[chat.recipient]}}</span>
                            <strong>NEW</strong>
                        </div>
                    </div>
                </li>

                <div ng-if="!vm.chats || !vm.chats.length" class="no-content">
                    <p class="message">With messages you can communicate with people youâ€™ve connected with in the Industry and want to stay in touch with!</p>
                    <p class="message">Get started by <strong><a ui-sref="account.profile.friends">adding friends</a></strong> or if you have already added friends to your convoy, use the <strong>New Message</strong> button below.</p>
                </div>

            </ul>
        </ion-scroll>   
        
    </ion-pane>
    
    <div class="material-action">
        <button class="button button-positive button-share" ng-click="vm.createNewChat()">
            <i class="icon ion-chatbubbles"></i>
        </button>
    </div>

</ion-view>