<ion-view class="profile-screen view-section mid-size" cache-view="false">
    <!--Profile Main Heading START-->
    <ion-header-bar align-title="center">
        <button ng-if="!!vm.showEditModal" class="button button-small button-icon icon ion-compose" ng-click="vm.showEditModal()"></button>
        <button ng-if="!vm.showEditModal" class="button button-clear" ui-sref="account.profile({userId: null})" ui-sref-opts="{reload: true}">
            <i class="ion-ios-arrow-back"></i>
            <span class="ico ico-avatarsmall ico-middle"></span>
        </button>
        <h1 class="title" ng-bind="vm.profileData.displayName">Profile</h1>
        <button class="button button-clear" ng-if="!!vm.showUserSettings" ng-click="vm.showUserSettings()">
            <i class="ico ico-settingsicon ico-text-top"></i>
        </button>
        <button class="button button-clear" ng-if="!!vm.doFriendAction" ng-click="vm.doFriendAction()">
            <span ng-if="vm.friendStatus === 'none'"><i class="ion-plus"></i> Add</span>
            <span ng-if="vm.friendStatus === 'sent'" class="badge badge-balanced">invited</span>
            <span ng-if="vm.friendStatus === 'friends'" class="badge badge-balanced">in convoy</span>
        </button>
    </ion-header-bar>

    <div class="profile-visual">
        <div class="photo" ng-click="vm.showEditAvatar()">
            <img ng-if="vm.profileData.props.avatar" ng-src="{{vm.profileData.props.avatar}}" alt="" />
        </div>
        <div class="contacts-amount" ng-click="vm.showFriends();">
            <span class="ico ico-friends ico-middle"></span>
            <span ng-if="vm.updates.requests" class="badge badge-assertive">{{vm.updates.requests}}</span>
            <strong>{{vm.profileData.friends.length}}</strong>
        </div>
        <div class="handle">
            <strong><i class="ico ico-radio"></i> {{vm.profileData.handle}}</strong>
        </div>
    </div>
    <!--Profile Main Heading END-->

    <!--Profile Main Body START-->
    <ion-pane class="profile-pane">
        <ion-tabs class="profile-tabs tabs-top content-pane" delegate-handle="profile-tabs">
            <ion-tab title="REVIEWS" ng-class="{'has-button': !!vm.showRequestReviewModal}">
                <ion-scroll class="reviews-list">
                    <ion-list>
                        <ion-item  ng-repeat="review in vm.reviews track by $index">
                            <div class="ico ico-avatarsmall"></div>
                            <div class="review">
                                <div class="top">
                                    <rating ng-if="!!review.rating" readonly="true" ng-model="review.rating" max="5"></rating>
                                    <div class="time"><i class="ico ico-timesmall"></i> {{review.created | date : 'mediumDate'}}</div>
                                </div>
                                <strong class="title">{{review.name}} - {{review.title}}</strong>
                                <div class="message">{{review.text}}</div>
                            </div>
                        </ion-item>
                    </ion-list>
                    <div ng-if="!vm.reviews || !vm.reviews.length" class="no-content">No Reviews yet</div>
                </ion-scroll>
                <button class="button content-button" ng-if="!!vm.showRequestReviewModal" ng-click="vm.showRequestReviewModal()"><i class="ico ico-request-review"></i>Request Review</button>
            </ion-tab>
            <ion-tab title="PROFILE" ui-sref="account.profile" class="content-pane" ng-class="{'has-button': !!vm.showShareModal || !vm.canEdit}"
            on-select="console.log('Load Tab %s', this)" on-deselect="console.log('Leave Tab %s', this)">
                <ion-scroll class="profile-list">
                    <div class="list">
                        <div class="item" ng-if="!!vm.profileData.props.title">
                            <span class="item-label">CURENT JOB TITLE:</span>
                            <span class="item-note">{{vm.profileData.props.title}}</span>
                        </div>
                        <div class="item">
                            <span class="item-label" ng-click="vm.ab()">TRUCK:</span>
                            <span class="item-note">
                                <div class="logo">
                                    <i ng-if="vm.trucksMap[vm.profileData.props.truck]" class="{{vm.trucksMap[vm.profileData.props.truck]}}"></i>
                                    <div ng-if="!vm.trucksMap[vm.profileData.props.truck]">{{vm.profileData.props.truck}} {{vm.profileData.props.model}}</div>
                                    <div ng-if="!vm.profileData.props.truck && vm.profileData.props.model">{{vm.profileData.props.model}}</div>
                                    <span ng-if="vm.trucksMap[vm.profileData.props.truck] && vm.profileData.props.model" class="badge badge-positive" >{{vm.profileData.props.model}}</span>
                                </div>
                            </span>
                        </div>
                        <div class="item">
                            <span class="item-label">TRAILER:</span>
                            <span class="item-note">
                                <span ng-repeat="trailer in vm.profileData.props.trailer">
                                    {{trailer}}<span ng-if="!$last">, </span>
                            </span>
                            </span>
                        </div>
                        <div class="item" ng-if="!!vm.profileData.props.started">
                            <span class="item-label">DRIVING SINCE:</span>
                            <span class="item-note">{{vm.profileData.props.started | monthDate | date : 'MMMM, yyyy'}}</span>
                        </div>
                        <div class="item item-divider"></div>
                        <div class="item" ng-if="!!vm.profileData.props.company">
                            <span class="item-label">DRIVING FOR:</span>
                            <span class="item-note">{{vm.profileData.props.company}}</span>
                        </div>
                        <div class="item" ng-if="vm.profileData.props.freight">
                            <span class="item-label"><span class="ico ico-freight"></span> FREIGHT:</span>
                            <span class="item-note">{{vm.profileData.props.freight}}</span>
                        </div>
                        <div class="item endorsements-row">
                            <span class="item-label">ENDORSEMENTS:</span>
                            <ul class="endorsements-list">
                                <li ng-repeat="endorsement in vm.profileData.license.endorsements">
                                    <i class="ico extra-small-size {{ vm.endorsementsMap[endorsement].ico}}"></i>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="profile-activity activity" ng-if="vm.feed">
                        <strong class="title">{{vm.profileData.firstName}}'s feed:</strong>
                        <oset-feed-item ng-if="vm.feed.length" ng-repeat="entry in vm.feed" model="entry"></oset-feed-item>
                        <div ng-if="!vm.feed.length" class="no-feed-items">{{ vm.feedMessage }}</div>
                    </div>
                </ion-scroll>
                <button class="button content-button" ng-if="!!vm.showShareModal" ng-click='vm.showShareModal()'> <i class="ico ico-shareiconorange"></i>Share</button>
                <button class="button content-button" ng-if="!vm.canEdit" ng-click="vm.openChat()"><i class="ico ico-shareiconorange"></i>Send Message</button>
            </ion-tab>
            <ion-tab title="EXPERIENCE" ng-class="{'has-button': !!vm.showAddExperienceModal}" class="content-pane" on-select="console.log('Load Tab %s', this)" on-deselect="console.log('Leave Tab %s', this)">
                <ion-scroll class="experience-list">
                    <ion-list>
                        <ion-item class="item" ng-repeat="job in vm.experience" ng-click="vm.showEditExperienceModal(job)">
                            <strong>{{job.title}} <span class="company" ng-if="!!job.company">, {{job.company}}</span></strong>
                            <p ng-if="!!job.description">{{job.description}}</p>
                            <p ng-if="!!job.location">{{job.location}}</p>
                            <em ng-if="!!job.startDate || job.endDate">
                                <i class="ico ico-timesmall"></i>
                                <span ng-if="!!job.startDate">{{job.startDate | monthDate | date : 'MMMM, yyyy'}}</span>
                                <span ng-if="!!job.startDate && job.endDate">-</span>
                                <span ng-if="!!job.endDate">{{job.endDate | monthDate | date : 'MMMM, yyyy'}}</span>
                            </em>
                        </ion-item>
                    </ion-list>
                    <div ng-if="!vm.experience || !vm.experience.length" class="no-content">No Experience</div>
                </ion-scroll>
                <button class="button content-button" ng-if="!!vm.showAddExperienceModal" ng-click="vm.showAddExperienceModal()"><i class="ico ico-shareiconorange"></i>Add Experience</button>
            </ion-tab>
        </ion-tabs>
    </ion-pane>

</ion-view>
