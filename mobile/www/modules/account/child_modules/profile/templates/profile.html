<ion-view class="profile-screen view-section mid-size" cache-view="false">

    <ion-header-bar align-title="center">
        <button class="button button-clear" ng-if="!!vm.showEditModal" ng-click="vm.showEditModal()">Edit</button>
        <button class="button button-clear" ng-if="!vm.showEditModal" ui-sref="account.profile">
            <i class="ion-ios-arrow-back"></i>
            <span class="ico ico-avatar ico-middle"></span>
        </button>
        <h1 class="title" ng-bind="vm.profileData.displayName">Profile</h1>
        <button class="button button-clear" ng-if="!!vm.showUserSettings" ng-click="vm.showUserSettings()">
            <i class="ico ico-settingsicon ico-text-top"></i>
        </button>
        <button class="button button-clear" ng-if="!!vm.doFriendAction" ng-click="vm.doFriendAction()">
            <span ng-if="vm.friendStatus === 0"><i class="ion-plus"></i> Add</span>
            <a ng-if="vm.friendStatus === 1" class="padding-top"><span ng-if="!!vm.friendStatus" class="badge badge-balanced">in convoy</span></a>
            <span ng-if="vm.friendStatus === -1"></span>
        </button>
    </ion-header-bar>

    <div class="profile-visual">
        <div class="photo" ng-click="vm.showEditAvatar()">
            <img ng-if="vm.profileData.props.avatar" ng-src="{{vm.profileData.props.avatar}}" alt="" />
        </div>
        <div class="contacts-amount" ng-click="vm.showFriends();">
            <span class="ico ico-avatar ico-middle"></span>
            <strong>{{vm.profileData.friends.length}}</strong>
        </div>
    </div>

    <ion-pane class="profile-pane">
        <ion-tabs class="profile-tabs tabs-top">
            <ion-tab title="REVIEWS" ui-sref="account.profile.reviews">
                <ion-scroll class="reviews-list">
                    <ion-list>
                        <ion-item ng-repeat="review in vm.reviews track by $index">
                            <div class="ico ico-avatar"></div>
                            <div class="review">
                                <div class="top">
                                    <div class="ratings" data-mark="{{review.rating}}"></div>
                                    <div class="time"><i class="ico ico-timesmall"></i> {{review.created | date : 'mediumDate'}}</div>
                                </div>
                                <strong class="title">{{review.name}} - {{review.title}}</strong>
                                <div class="message">{{review.text}}</div>
                            </div>
                        </ion-item>
                    </ion-list>
                </ion-scroll>
                <button class="button content-button" ng-if="!!vm.showRequestReviewModal" ng-click="vm.showRequestReviewModal()"><i class="ico ico-request-review"></i>Request Review</button>
            </ion-tab>
            <ion-tab title="PROFILE" ui-sref="account.profile">
                <ion-scroll class="profile-list">
                    <div class="list">
                        <div class="item" ng-if="!!vm.profileData.props.title">
                            CUURENT JOB TITLE:
                            <span class="item-note">{{vm.profileData.props.title}}</span>
                        </div>
                        <div class="item">
                            TRUCK:
                            <span class="item-note">{{vm.profileData.props.truck}}</span>
                        </div>
                        <div class="item">
                            TRAILER:
                            <span class="item-note">
                                <span ng-repeat="trailer in vm.profileData.props.trailer">
                                    {{trailer}}<span ng-if="!$last">, </span>
                            </span>
                            </span>
                        </div>
                        <div class="item">
                            DRIVING SINCE:
                            <span class="item-note">{{vm.profileData.props.started | monthDate | date : 'MMMM, yyyy'}}</span>
                        </div>
                        <div class="item item-divider"></div>
                        <div class="item">
                            COMPANY:
                            <span class="item-note">{{vm.profileData.company || vm.profileData.props.company}}</span>
                        </div>
                        <div class="item" ng-if="vm.profileData.props.freight">
                            <span class="ico ico-freight"></span> FREIGHT:
                            <span class="item-note">{{vm.profileData.props.freight}}</span>
                        </div>
                        <div class="item endorsements-row">
                            ENDORSEMENTS:
                            <ul class="endorsements-list">
                                <li ng-repeat="endorsement in vm.profileData.license.endorsements">
                                    <i class="ico icon {{ vm.endorsementsMap[endorsement].ico}}"></i>
                                </li>
                            </ul>
                        </div>
                    </div>
                </ion-scroll>
                <button class="button content-button" ng-if="!!vm.showShareModal" ng-click="vm.showShareModal()"><i class="ico ico-share"></i>Share</button>
            </ion-tab>
            <ion-tab title="EXPERIENCE" ui-sref="account.profile.experience">
                <ion-scroll class="experience-list">
                    <ion-list>
                        <ion-item class="item" ng-repeat="job in vm.experience" ng-click="vm.showEditExperienceModal(job)">
                            <strong>{{job.title}}</strong>
                            <p ng-if="!!job.description">{{job.description}}</p>
                            <p ng-if="!!job.location">{{job.location}}</p>
                            <em ng-if="!!job.startDate || job.endDate">
                                <i class="ico ico-timesmall"></i>
                                <span ng-if="!!job.startDate">{{job.startDate | monthDate | date : 'MMMM, yyyy'}}</span>
                                <span ng-if="!!job.startDate && job.endDate">-</span>
                                <span ng-if="!!job.endDate">{{job.endDate | monthDate | date : 'MMMM, yyyy'}}</span>
                            </em>
                        </ion-item>
                    </ion-list>
                    <ion-item ng-if="vm.experience.length === 0" class="item center">
                        <strong>No Experience</strong>
                    </ion-item>
                </ion-scroll>
                <button class="button content-button" ng-click="vm.showAddExperienceModal()"><i class="ico ico-share"></i>Add Experience</button>
            </ion-tab>
        </ion-tabs>
    </ion-pane>

</ion-view>
