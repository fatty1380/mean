<ion-view class="profile-screen view-section" cache-view="false">

    <div class="material-action">
        <button class="button button-energized button-share" ng-if="vm.showShareModal" ng-click="vm.showShareModal()">
            <i class="icon ion-android-share"></i>
        </button>

        <button class="button button-calm" ng-if="!vm.canEdit" ng-click="vm.openChat()">
            <i class="icon ion-chatbubbles"></i>
        </button>
    </div>


    <!--Profile Main Heading START-->
    <ion-header-bar align-title="center">
        <button ng-if="!vm.showEditModal" class="button button-clear" ng-click="vm.goBack()">
            <i class="ion-ios-arrow-back"></i>
            <span class="ico ico-avatarsmall ico-middle"></span>
        </button>

        <div class="profile-visual">
            <div class="photo" ng-click="vm.showEditAvatar()">
                <img ng-if="vm.profileData.profileImageURL" ng-src="{{vm.profileData.profileImageURL}}" alt="" />
            </div>
        </div>


        <div class="header-actions left">
            <button class="button button-clear button-edit" ng-if="!!vm.showEditModal" ng-click="vm.showEditModal()">
                <i class="icon ion-ios-gear"></i>
            </button>
        </div>

        <div class="header-actions right">
        </div>

    </ion-header-bar>

    <!--Profile Main Heading END-->

    <!--Profile Main Body START-->
    <ion-pane class="profile-pane">
        <div title="PROFILE" class="profile-tabs content-pane" ng-class="{'view-only': !vm.canEdit}">



            <ion-scroll class="list">
                <!--<button class="button button-icon ion-compose button-pos-tr" ng-if="!!vm.showEditModal" ng-click="vm.showEditModal()"></button>-->
                <div class="profile-list">

                    <div class="profile-title">
                        <h3>{{vm.profileData.displayName}}</h3>
                    </div>

                    <ion-item class="profile-highlights">
                        <div class="handle" ng-if="!!vm.profileData.handle">
                            <i class="ico ico-radio-badge"></i> {{vm.profileData.handle | uppercase}}
                        </div>
                        <div class="friends clickable" ng-click="vm.showFriends($event);">
                            <i class="ico ico-friend-badge"></i>{{vm.profileData.friends.length}} Friends
                            <span class="badge-container">
                            <span ng-if="vm.canEdit && vm.updates.requests" class="badge badge-assertive">{{vm.updates.requests}}</span>
                            </span>
                        </div>

                        <div class="message clickable" ng-click="vm.messageClick($event);">
                            <i class="ico ico-message-badge"></i>
                            <span class="badge-container">
                                <span ng-if="vm.canEdit && vm.updates.messages.amount" class="badge badge-assertive">{{vm.updates.messages.amount}}</span>
                            </span>

                        </div>
                    </ion-item>

                    <ion-item class="profile-bubbles">
                        <div class="circle">
                            <div class="miles-badge">
                                {{vm.thousandsOfMiles}}<span class="small">k</span>
                                <span class="label-text bot">miles</span>
                            </div>
                        </div>
                        <div class="circle">
                            <div class="license-badge">
                                <span class="label-text top">class</span> {{vm.profileData.license.class}}
                                <span class="label-text bot hide">license</span>
                            </div>
                        </div>
                        <div class="circle">
                            <div class="experience-badge">
                                5
                                <span class="label-text bot">years</span>
                            </div>
                        </div>
                    </ion-item>

                    <ion-item class="equipment card">
                        <h4 class="item-label">Equipment</h4>
                        <button class="button button-icon ion-compose button-pos-tr" ng-if="!!vm.showEditModal" ng-click="vm.showEditModal()"></button>


                        <div class="exp-item">
                            <div class="row">
                                <div class="col">
                                    <span ng-repeat="trailer in vm.profileData.props.trailer">
                                    {{trailer}}<span ng-if="!$last">, </span>
                                    </span>
                                </div>
                            </div>
                        </div>

                        <h4 class="item-label">Endorsements</h4>
                        <div class="exp-item">
                            <div class="row">
                                <div class="col">
                                    <span ng-repeat="endorsement in vm.profileData.license.endorsements">
                                    <strong>{{endorsement}}:</strong> {{ vm.endorsementsMap[endorsement].title }}
                                    <br ng-if="!$last" />
                                </span>
                                </div>
                            </div>
                        </div>

                        <div class="circle">
                            <div class="equipment-logo">
                                <i ng-if="vm.trucksMap[vm.profileData.props.truck]" class="ico-t {{vm.trucksMap[vm.profileData.props.truck]}}"></i>
                                <div ng-if="!!vm.profileData.props.truck && !vm.trucksMap[vm.profileData.props.truck]">{{vm.profileData.props.truck}} {{vm.profileData.props.model}}</div>
                                <div ng-if="!vm.profileData.props.truck && vm.profileData.props.model">{{vm.profileData.props.model}}</div>
                            </div>
                            <span ng-if="vm.trucksMap[vm.profileData.props.truck] && vm.profileData.props.model" class="badge badge-positive">
                                {{vm.profileData.props.model}}
                            </span>
                        </div>

                    </ion-item>

                    <ion-item class="card experience">
                        <h4 class="item-label">Experience</h4>
                        <button ng-if="vm.canEdit &&  !!vm.experience.length" class="button button-icon ion-compose button-pos-tr" ng-click="vm.showExperienceListModal()"></button>
                        <button ng-if="vm.canEdit && !vm.experience.length" class="button button-icon ion-ios-plus-outline button-pos-tr" ng-click="vm.showAddExperienceModal()"></button>

                        <span ng-repeat="exp in (vm.experience) track by $index">
                            <div class="exp-item">
                                <div class="row">
                                    <div class="col">
                                        <div class="company" ng-if="!!exp.company"> {{exp.company}}</div>
                                    </div>
                                    <div class="col text-right">
                                        <div class="time" ng-if="!!exp.startDate || exp.endDate">
                                            <i class="ico ico-timesmall"></i>
                                            <span ng-if="!!exp.startDate">{{exp.startDate | monthDate | date : 'yyyy'}}</span>
                                            <span ng-if="!!exp.startDate && exp.startDate !== exp.endDate">-</span>
                                            <span ng-if="!!exp.endDate">{{exp.endDate | monthDate | date : 'yyyy'}}</span>
                                            <span ng-if="!exp.endDate">Now</span>
                                        </div>
                                    </div>
        </div>

        <div class="row">
            <div class="col">
                <div class="title">{{exp.title}}</div>
            </div>
            <div class="col text-right">
                <div class="location" ng-if="!!exp.location">{{exp.location}}</div>
            </div>
        </div>

        </div>
        <div class="exp-spacer" ng-if="!$last">&nbsp;</div>
        </span>

        </ion-item>
        </div>

        <div name="activity-list">

            <div class="item item-divider" ng-if="vm.feed"></div>

            <div class="item activity profile-activity" ng-if="vm.feed">
                <span class="item-label">ACTIVITY:</span>
                <div class="text-center item-loading" ng-if="vm.feedLoading">
                    <ion-spinner></ion-spinner>
                </div>
                <oset-feed-item ng-if="vm.feed.length" ng-repeat="entry in vm.feed" model="entry"></oset-feed-item>
                <div ng-if="!vm.feed.length && !vm.feedLoading" class="no-feed-items">{{ vm.feedMessage }}</div>
            </div>

        </div>
        </ion-scroll>

        </div>
    </ion-pane>

</ion-view>